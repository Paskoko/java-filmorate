DROP TABLE USERS,
		FRIENDS,
		LIKES,
		MPA_RATING,
		GENRES,
		FILM_GENRE,
		FILMS;

CREATE TABLE users (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	email varchar(40) NOT NULL,
	login varchar(40) NOT NULL,
	name varchar(40),
	birthday DATE
);

CREATE TABLE friends (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	user_id INTEGER REFERENCES users (id) ON DELETE CASCADE,
	friend_id INTEGER,
	status varchar(10)
);


CREATE TABLE MPA_rating (
	id INTEGER PRIMARY KEY,
	name varchar(5)
);

CREATE TABLE films (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name varchar(40),
	description varchar(1000),
	release_date DATE,
	duration INTEGER,
	rate INTEGER,
	rating_id INTEGER REFERENCES MPA_rating (id) ON DELETE RESTRICT
);

CREATE TABLE likes (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	film_id INTEGER REFERENCES films (id) ON DELETE CASCADE,
	user_id INTEGER REFERENCES users (id) ON DELETE CASCADE
);

CREATE TABLE genres (
	id INTEGER PRIMARY KEY,
	name varchar(40)
);

CREATE TABLE film_genre (
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	film_id INTEGER REFERENCES films (id) ON DELETE CASCADE,
	genre_id INTEGER REFERENCES genres (id) ON DELETE CASCADE
);

